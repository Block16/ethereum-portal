<main>
	<h1 class="top-border head1 type2"
			[ngStyle]="theme.textStyle">Ethereum Portal</h1>
	<div *ngIf="currentAuth == AuthState.none"
			 class="grid">
		<div class="grid-cell">
			<h2 class="top-border">Select auth methods</h2>
			
			<section class="section-content">
				<h3 class="fade">MetaMask and Ledger are recognized automatically.</h3>
				<button class="button"
								(click)="currentAuth = AuthState.metamask">FAKE AUTH</button><br><br>
				<button class="button auth-button"
								(click)="trezorAuthState()">
					<img src="/assets/img/icons/trezor icon.svg"
							 class="icon">
				</button>
				<button class="button auth-button"
								(click)="toggleAuthState(AuthState.bitbox)">
					<img src="/assets/img/icons/digital bitbox icon.svg"
							 class="icon">
				</button>
				<button class="button auth-button"
								(click)="toggleAuthState(AuthState.ledger)">
					<img src="/assets/img/icons/ledger icon.svg"
							 class="icon">
				</button>
				<button class="button auth-button"
								(click)="metaMaskAuthState()"
	              *ngIf="detectedInjectedProvider">
					<img src="/assets/img/icons/metamask icon.svg"
							 class="icon">
				</button>
				<br><br>

				<button class="button file-upload">
					<input type="file"
								 id="utc-upload"
								 (change)="utcInputChange($event)">
								 <span>{{ fileUploadText }}</span>
				</button>
				<br><br>
				<button class="button"
								(click)="showTestModal = !showTestModal">show test modal</button>
			</section>
			<h3 class="section-toggle top-border"
					[ngClass]="{ 'open': showNonRecommended }"
					(click)="showNonRecommended = !showNonRecommended">Non-recommended methods</h3>
			<section *ngIf="showNonRecommended"
							 class="section-content">
        <app-private-key-form (privateKey)="privateKeyAuthState($event)"></app-private-key-form>
			</section>
		</div>
		<div class="grid-cell">
			<h2 class="top-border">Don't have a wallet?</h2>
		</div>
	</div>

	<div *ngIf="currentAuth != AuthState.none"
			 class="grid">
		<div class="grid-cell">
			<h2 class="top-border head2 type2">View</h2>
			<section class="section-content">
				<div class="caption ">Address</div>
				<p class="lining-proportional">0x{{ ethereumAddress }}</p>
				<div class="caption">ETH</div>
				<p class="lining-proportional">{{ ethereumBalance }}</p>
				<div class="tokens bottom-margin">
					<div class="token"
							 *ngFor="let token of assets['tokens']; let i = index">
						<div class="caption">{{ assets['tokens'][i].name }}</div>
						<p class="lining-proportional">{{ assets['tokens'][i].amount }}</p>
					</div>
				</div>
				<h3 class="section-toggle top-border no-bottom-margin"
						[ngClass]="{ 'open': showQR }"
						(click)="showQR = !showQR">QR</h3>
				<section class="section-content"
								 *ngIf="showQR">
					<img src="assets/img/QR dummy.png"
							 class="qr">
				</section>
				<loading-icon></loading-icon>
			</section>
		</div>
		<div class="grid-cell">
			<h2 class="top-border head2 type2">Send</h2>
			<section class="section-content">
				<label for="text-to-address" class="caption form-label">To <span class="fade">Ethereum address</span></label>
				<input type="text"
							 id="text-to-address"
						   [(ngModel)]="sendAddress"
							 class="wide"><br><br>
				<label for="text-amount" class="caption form-label">Amount</label>
				<div class="text-input-plus">
					<input type="number"
								 id="text-amount"
								 [(ngModel)]="sendAmount"
								 (ngModelChange)="changeSendAmount()"
								 class="wide no-arrow-buttons">
					<div class="max-button"
							 [ngClass]="{ 'on': sendMax }"
							 (click)="clickMaxButton()">Max</div>
					<div class="custom-select">
						<div class="select-overlay">
							<span>{{ sendAssetName(sendAsset) }}</span>
						</div>
						<select name="" id=""
									  [(ngModel)]="sendAsset"
									  (change)="changeSendAsset()">
							<option value="-1">ETH</option>
							<option *ngFor="let token of assets['tokens']; let i = index" value="{{i}}">{{ assets['tokens'][i].name }}</option>
						</select>
					</div>
				</div>
				<div *ngIf="!userPreferences['manualGas']">
					<div class="caption">Estimated transaction fee</div>
					<p class="lining-proportional">.0003 ETH</p>
				</div>
				<div *ngIf="userPreferences['manualGas']">
					<label for="gas-price" class="caption form-label">Gas price</label>
					<input id="gas-price" type="range">

					<label for="gas-limit" class="caption form-label">Gas limit</label>
					<input id="gas-limit" type="number" class="no-arrow-buttons">
				</div>
				<button class="button">Generate transaction</button><br>
			</section>
		</div>
<!-- 		<div class="grid-cell">
			<h2 class="top-border head2 type2">Something else</h2>
			<section class="section-content">
				<loading-icon></loading-icon>
			</section>
		</div> -->
		<div class="grid-cell">
			<h2 class="top-border head2 type2">History</h2>
			<section class="section-content">
				<app-transaction-list></app-transaction-list>
			</section>
		</div>
	</div>
</main>

<div class="new-transaction-circle"
		 [ngClass]="{ 'small': newTransactionToDock }"
		 [ngStyle]="newTransactionCircleStyle">
</div>
<div class="new-transaction"
		 [ngStyle]="newTransactionStyle">
	<div class="content">
		<h1 class="top-border">Approve transaction</h1>
		<section class="section-content">
			<h3 class="type2">Transaction will send immediately after approval on your [auth method]</h3>
			<span class="caption">To</span><br>
			<p class="lining-proportional">{{newTransaction.toAddress}}</p>
			<span class="caption">From</span><br>
			<p class="lining-proportional">{{newTransaction.fromAddress}}</p>
			<span class="caption">Amount</span><br>
			<p class="lining-proportional">{{newTransaction.amount}} {{newTransaction.token}}</p>
			<span class="caption">Estimated transaction fees</span><br>
			<p class="lining-proportional">.0008 ETH</p>
		</section>
	</div>
</div>

<div #_recentTransactions
		 class="recent-transactions"
		 (click)="setShowSidebar(true)">
	<div *ngFor="let transaction of recentTransactions"
				class="transaction"
				[ngClass]="{'processing': transaction.status == 'processing',
										'confirmed': transaction.status == 'confirmed',
										'failed': transaction.status == 'failed'}"></div>
</div>

<modal [(visible)]="showTestModal"
			 [title]="'Title'">hello</modal>


<modal [(visible)]="showUTCPasswordModal"
			 [title]="'UTC password'">
	<section class="section-content pad-left">
		<label for="utc-password" class="caption form-label">Password</label>
		<input type="password" class="wide" id="utc-password">
	</section>
	<button class="button wide">Submit</button>
</modal>

<div class="dev-buttons">
	<div class="dev-button"
			 (click)="showTestModal = !showTestModal">Show test modal</div>
	<div class="dev-button"
		 	 (click)="showApproveNewTransaction()">Generate transaction</div>
	<div class="dev-button"
		 	 (click)="transactionSigned()">Sign transaction</div>
</div>
