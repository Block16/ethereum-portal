<main>
	<h1 class="top-border head1 type2"
			[ngStyle]="theme.textStyle">Ethereum Portal</h1>
	<div *ngIf="currentAuth == AuthState.none"
			 class="grid">
		<div class="grid-cell">
			<h2 class="top-border">Select wallet</h2>
			<section class="section-content">
				<div class="wallets">
					<div class="wallet">
						<div class="wallet-icon"
								 (click)="metaMaskAuthState()">
							<img src="assets/img/icons/metamask icon light.svg" alt="">
						</div>
						<span class="head3">Metamask</span>
					</div>
					<div class="wallet">
						<div class="wallet-icon"
								 (click)="toggleAuthState(AuthState.ledger)">
							<img src="assets/img/icons/ledger icon light.svg" alt="">
						</div>
						<span class="head3">Ledger</span>
					</div>
					<div class="wallet">
						<div class="wallet-icon"
								 (click)="trezorAuthState()">
							<img src="assets/img/icons/trezor icon light.svg" alt="">
						</div>
						<span class="head3">Trezor</span>
					</div>
					<div class="wallet">
						<div class="wallet-icon"
								 (click)="toggleAuthState(AuthState.bitbox)">
							<img src="assets/img/icons/digital bitbox icon light.svg" alt="">
						</div>
						<span class="head3">Digital Bitbox</span>
					</div>
					
					<div class="wallet">
						<div class="wallet-icon">
							<app-utc-file-form (privateKey)="utcAuthState($event)"></app-utc-file-form>
						  <img src="assets/img/icons/utc icon light.svg" alt="">
						</div>
						<span class="head3">.UTC file</span>
					</div>
				</div>
				<br>
			</section>
			<h3 class="section-toggle top-border"
					[ngClass]="{ 'open': showNonRecommended }"
					(click)="showNonRecommended = !showNonRecommended">Non-recommended methods</h3>
			<section *ngIf="showNonRecommended"
							 class="section-content">
        <app-private-key-form (privateKey)="privateKeyAuthState($event)"></app-private-key-form>
				<button class="button"
								(click)="currentAuth = AuthState.metamask">FAKE AUTH</button>
				<br><br>
				<button class="button"
								(click)="showTestModal = !showTestModal">show test modal</button>
			</section>
		</div>
		<div class="grid-cell">
			<h2 class="top-border">Don't have a wallet?</h2>
		</div>
	</div>

	<div *ngIf="currentAuth != AuthState.none"
			 class="grid">
		<div class="grid-cell">
			<h2 class="top-border head2 type2">View</h2>
			<section class="section-content">
				<div class="caption ">Address</div>
				<p class="lining-proportional">0x{{ ethereumAddress }}</p>
				<div class="caption">ETH</div>
				<p class="lining-proportional">{{ ethereumBalance }}</p>
				<div class="tokens bottom-margin">
					<div class="token"
							 *ngFor="let token of assets['tokens']; let i = index">
						<div class="caption">{{ assets['tokens'][i].name }}</div>
						<p class="lining-proportional">{{ assets['tokens'][i].amount }}</p>
					</div>
				</div>
				<h3 class="section-toggle top-border no-bottom-margin"
						[ngClass]="{ 'open': showQR }"
						(click)="showQR = !showQR">QR</h3>
				<section class="section-content"
								 *ngIf="showQR">
					<img src="assets/img/QR dummy.png"
							 class="qr">
				</section>
				<loading-icon></loading-icon>
			</section>
		</div>
		<div class="grid-cell">
			<h2 class="top-border head2 type2">Send</h2>
			<section class="section-content">
        <form [formGroup]="sendForm" (submit)="sendTransaction()">

				  <label for="text-to-address" class="caption form-label">To <span class="fade">Ethereum address</span></label>
				  <input type="text" id="text-to-address" [formControl]="sendForm.controls['sendAddress']" class="wide">

          <br><br>

				  <label for="text-amount" class="caption form-label">Amount</label>
				  <div class="text-input-plus">

				  	<input type="number" id="text-amount" [formControl]="sendForm.controls['sendAmount']" class="wide no-arrow-buttons">

            <div class="max-button"
				  			 [ngClass]="{ 'on': sendMax }"
				  			 (click)="clickMaxButton()">Max</div>

				  	<div class="custom-select">
				  		<div class="select-overlay">
				  			<span>{{ sendAssetName(sendAsset) }}</span>
				  		</div>
				  		<select name="asset-selection" id="asset-selection" [formControl]="sendForm.controls['sendAsset']">
				  			<option value="-1">ETH</option>
				  			<option *ngFor="let token of assets['tokens']; let i = index" value="{{i}}">{{ assets['tokens'][i].name }}</option>
				  		</select>
				  	</div>

				  </div>

				  <div *ngIf="!userPreferences['manualGas']">
				  	<div class="caption">Estimated transaction fee</div>
				  	<p class="lining-proportional">.0003 ETH</p>
				  </div>

				  <div *ngIf="userPreferences['manualGas']">
				  	<label for="gas-price" class="caption form-label">Gas price</label>
				  	<input id="gas-price" type="range">

				  	<label for="gas-limit" class="caption form-label">Gas limit</label>
				  	<input id="gas-limit" type="number" class="no-arrow-buttons">
				  </div>

				  <button class="button" type="submit" [ngClass]="{ 'disabled': !sendForm.valid }">Generate transaction</button>
          <br>
        </form>
			</section>
		</div>
<!-- 		<div class="grid-cell">
			<h2 class="top-border head2 type2">Something else</h2>
			<section class="section-content">
				<loading-icon></loading-icon>
			</section>
		</div> -->
		<div class="grid-cell">
			<h2 class="top-border head2 type2">History</h2>
			<section class="section-content">
				<app-transaction-list></app-transaction-list>
			</section>
		</div>
	</div>
</main>

<div class="new-transaction-circle"
		 [ngClass]="{ 'small': newTransactionToDock }"
		 [ngStyle]="newTransactionCircleStyle">
</div>
<div class="new-transaction"
		 [ngStyle]="newTransactionStyle">
	<div class="content">
		<h1 class="top-border">Approve transaction</h1>
		<section class="section-content">
			<h3 class="type2">Transaction will send immediately after approval on your [auth method]</h3>
			<span class="caption">To</span><br>
			<p class="lining-proportional">{{newTransaction.toAddress}}</p>
			<span class="caption">From</span><br>
			<p class="lining-proportional">{{newTransaction.fromAddress}}</p>
			<span class="caption">Amount</span><br>
			<p class="lining-proportional">{{newTransaction.amount}} {{newTransaction.token}}</p>
			<span class="caption">Estimated transaction fees</span><br>
			<p class="lining-proportional">.0008 ETH</p>
		</section>
	</div>
</div>

<div #_recentTransactions
		 class="recent-transactions"
		 (click)="setShowSidebar(true)">
	<div *ngFor="let tx of recentTransactions"
				class="transaction">
		<transaction-dot [status]="tx.status"></transaction-dot>
	</div>
</div>

<modal [(visible)]="showTestModal"
			 [title]="'Title'">hello</modal>

<div class="dev-buttons">
	<div class="dev-button"
			 (click)="showTestModal = !showTestModal">Show test modal</div>
	<div class="dev-button"
		 	 (click)="showApproveNewTransaction()">Generate transaction</div>
	<div class="dev-button"
		 	 (click)="transactionSigned()">Sign transaction</div>
</div>
